<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>S3TO.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">cloud-core (18-mrt-2016 13:14:54)</a> &gt; <a href="../../index.html" class="el_group">cloud-api</a> &gt; <a href="../index.html" class="el_bundle">src</a> &gt; <a href="index.source.html" class="el_package">com.cloud.agent.api.to</a> &gt; <span class="el_source">S3TO.java</span></div><h1>S3TO.java</h1><pre class="source lang-java linenums">// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// &quot;License&quot;); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
package com.cloud.agent.api.to;

import java.util.Date;

import com.cloud.agent.api.LogLevel;
import com.cloud.agent.api.LogLevel.Log4jLevel;
import com.cloud.storage.DataStoreRole;
import com.cloud.utils.storage.S3.ClientOptions;

public final class S3TO implements ClientOptions, DataStoreTO {

    private Long id;
    private String uuid;
    @LogLevel(Log4jLevel.Off)
    private String accessKey;
    @LogLevel(Log4jLevel.Off)
    private String secretKey;
    private String endPoint;
    private String bucketName;
    private String signer;
    private Boolean httpsFlag;
    private Boolean useTCPKeepAlive;
    private Integer connectionTimeout;
    private Integer maxErrorRetry;
    private Integer socketTimeout;
    private Integer connectionTtl;
    private Date created;
    private boolean enableRRS;
    private long maxSingleUploadSizeInBytes;
    private static final String pathSeparator = &quot;/&quot;;

<span class="nc" id="L48">    public S3TO(final Long id, final String uuid, final String accessKey, final String secretKey, final String endPoint, final String bucketName,</span>
            final String signer, final Boolean httpsFlag, final Integer connectionTimeout, final Integer maxErrorRetry, final Integer socketTimeout,
            final Date created, final boolean enableRRS, final long maxUploadSize, final Integer connectionTtl, final Boolean useTCPKeepAlive) {

<span class="nc" id="L52">        this.id = id;</span>
<span class="nc" id="L53">        this.uuid = uuid;</span>
<span class="nc" id="L54">        this.accessKey = accessKey;</span>
<span class="nc" id="L55">        this.secretKey = secretKey;</span>
<span class="nc" id="L56">        this.endPoint = endPoint;</span>
<span class="nc" id="L57">        this.bucketName = bucketName;</span>
<span class="nc" id="L58">        this.signer = signer;</span>
<span class="nc" id="L59">        this.httpsFlag = httpsFlag;</span>
<span class="nc" id="L60">        this.connectionTimeout = connectionTimeout;</span>
<span class="nc" id="L61">        this.maxErrorRetry = maxErrorRetry;</span>
<span class="nc" id="L62">        this.socketTimeout = socketTimeout;</span>
<span class="nc" id="L63">        this.created = created;</span>
<span class="nc" id="L64">        this.enableRRS = enableRRS;</span>
<span class="nc" id="L65">        this.maxSingleUploadSizeInBytes = maxUploadSize;</span>
<span class="nc" id="L66">        this.connectionTtl = connectionTtl;</span>
<span class="nc" id="L67">        this.useTCPKeepAlive = useTCPKeepAlive;</span>

<span class="nc" id="L69">    }</span>

    public Long getId() {
<span class="nc" id="L72">        return this.id;</span>
    }

    public void setId(final Long id) {
<span class="nc" id="L76">        this.id = id;</span>
<span class="nc" id="L77">    }</span>

    @Override
    public String getUuid() {
<span class="nc" id="L81">        return this.uuid;</span>
    }

    @Override
    public String getUrl() {
<span class="nc" id="L86">        return null;</span>
    }

    public void setUuid(final String uuid) {
<span class="nc" id="L90">        this.uuid = uuid;</span>
<span class="nc" id="L91">    }</span>

    @Override
    public String getAccessKey() {
<span class="nc" id="L95">        return this.accessKey;</span>
    }

    public void setAccessKey(final String accessKey) {
<span class="nc" id="L99">        this.accessKey = accessKey;</span>
<span class="nc" id="L100">    }</span>

    @Override
    public String getSecretKey() {
<span class="nc" id="L104">        return this.secretKey;</span>
    }

    public void setSecretKey(final String secretKey) {
<span class="nc" id="L108">        this.secretKey = secretKey;</span>
<span class="nc" id="L109">    }</span>

    @Override
    public String getEndPoint() {
<span class="nc" id="L113">        return this.endPoint;</span>
    }

    public void setEndPoint(final String endPoint) {
<span class="nc" id="L117">        this.endPoint = endPoint;</span>
<span class="nc" id="L118">    }</span>

    public String getBucketName() {
<span class="nc" id="L121">        return this.bucketName;</span>
    }

    public void setBucketName(final String bucketName) {
<span class="nc" id="L125">        this.bucketName = bucketName;</span>
<span class="nc" id="L126">    }</span>

    @Override
    public String getSigner() {
<span class="nc" id="L130">        return this.signer;</span>
    }

    public void setSigner(final String signer) {
<span class="nc" id="L134">        this.signer = signer;</span>
<span class="nc" id="L135">    }</span>

    @Override
    public Boolean isHttps() {
<span class="nc" id="L139">        return this.httpsFlag;</span>
    }

    public void setHttps(final Boolean httpsFlag) {
<span class="nc" id="L143">        this.httpsFlag = httpsFlag;</span>
<span class="nc" id="L144">    }</span>

    @Override
    public Integer getConnectionTimeout() {
<span class="nc" id="L148">        return connectionTimeout;</span>
    }

    public void setConnectionTimeout(final Integer connectionTimeout) {
<span class="nc" id="L152">        this.connectionTimeout = connectionTimeout;</span>
<span class="nc" id="L153">    }</span>

    @Override
    public Integer getMaxErrorRetry() {
<span class="nc" id="L157">        return maxErrorRetry;</span>
    }

    public void setMaxErrorRetry(final Integer maxErrorRetry) {
<span class="nc" id="L161">        this.maxErrorRetry = maxErrorRetry;</span>
<span class="nc" id="L162">    }</span>

    @Override
    public Integer getSocketTimeout() {
<span class="nc" id="L166">        return socketTimeout;</span>
    }

    public void setSocketTimeout(final Integer socketTimeout) {
<span class="nc" id="L170">        this.socketTimeout = socketTimeout;</span>
<span class="nc" id="L171">    }</span>

    @Override
    public Integer getConnectionTtl() {
<span class="nc" id="L175">        return this.connectionTtl;</span>
    }

    public void setConnectionTtl(final Integer connectionTtl) {
<span class="nc" id="L179">        this.connectionTtl = connectionTtl;</span>
<span class="nc" id="L180">    }</span>

    @Override
    public Boolean getUseTCPKeepAlive() {
<span class="nc" id="L184">        return this.useTCPKeepAlive;</span>
    }

    public void setUseTCPKeepAlive(final Boolean useTCPKeepAlive) {
<span class="nc" id="L188">        this.useTCPKeepAlive = useTCPKeepAlive;</span>
<span class="nc" id="L189">    }</span>

    public Date getCreated() {
<span class="nc" id="L192">        return this.created;</span>
    }

    public void setCreated(final Date created) {
<span class="nc" id="L196">        this.created = created;</span>
<span class="nc" id="L197">    }</span>

    @Override
    public DataStoreRole getRole() {
<span class="nc" id="L201">        return DataStoreRole.Image;</span>
    }

    public boolean getEnableRRS() {
<span class="nc" id="L205">        return enableRRS;</span>
    }

    public void setEnableRRS(boolean enableRRS) {
<span class="nc" id="L209">        this.enableRRS = enableRRS;</span>
<span class="nc" id="L210">    }</span>

    public long getMaxSingleUploadSizeInBytes() {
<span class="nc" id="L213">        return maxSingleUploadSizeInBytes;</span>
    }

    public void setMaxSingleUploadSizeInBytes(long maxSingleUploadSizeInBytes) {
<span class="nc" id="L217">        this.maxSingleUploadSizeInBytes = maxSingleUploadSizeInBytes;</span>
<span class="nc" id="L218">    }</span>

    public boolean getSingleUpload(long objSize) {
<span class="nc bnc" id="L221" title="All 2 branches missed.">        if (maxSingleUploadSizeInBytes &lt; 0) {</span>
            // always use single part upload
<span class="nc" id="L223">            return true;</span>
<span class="nc bnc" id="L224" title="All 2 branches missed.">        } else if (maxSingleUploadSizeInBytes == 0) {</span>
            // always use multi part upload
<span class="nc" id="L226">            return false;</span>
        } else {
            // check object size to set flag
<span class="nc bnc" id="L229" title="All 2 branches missed.">            if (objSize &lt; maxSingleUploadSizeInBytes) {</span>
<span class="nc" id="L230">                return true;</span>
            } else {
<span class="nc" id="L232">                return false;</span>
            }
        }
    }

    @Override
    public String getPathSeparator() {
<span class="nc" id="L239">        return pathSeparator;</span>
    }

    @Override
    public boolean equals(final Object thatObject) {

<span class="nc bnc" id="L245" title="All 2 branches missed.">        if (this == thatObject) {</span>
<span class="nc" id="L246">            return true;</span>
        }
<span class="nc bnc" id="L248" title="All 4 branches missed.">        if (thatObject == null || getClass() != thatObject.getClass()) {</span>
<span class="nc" id="L249">            return false;</span>
        }

<span class="nc" id="L252">        final S3TO thatS3TO = (S3TO)thatObject;</span>

<span class="nc bnc" id="L254" title="All 6 branches missed.">        if (httpsFlag != null ? !httpsFlag.equals(thatS3TO.httpsFlag) : thatS3TO.httpsFlag != null) {</span>
<span class="nc" id="L255">            return false;</span>
        }

<span class="nc bnc" id="L258" title="All 6 branches missed.">        if (accessKey != null ? !accessKey.equals(thatS3TO.accessKey) : thatS3TO.accessKey != null) {</span>
<span class="nc" id="L259">            return false;</span>
        }

<span class="nc bnc" id="L262" title="All 6 branches missed.">        if (connectionTimeout != null ? !connectionTimeout.equals(thatS3TO.connectionTimeout) : thatS3TO.connectionTimeout != null) {</span>
<span class="nc" id="L263">            return false;</span>
        }

<span class="nc bnc" id="L266" title="All 6 branches missed.">        if (endPoint != null ? !endPoint.equals(thatS3TO.endPoint) : thatS3TO.endPoint != null) {</span>
<span class="nc" id="L267">            return false;</span>
        }

<span class="nc bnc" id="L270" title="All 6 branches missed.">        if (id != null ? !id.equals(thatS3TO.id) : thatS3TO.id != null) {</span>
<span class="nc" id="L271">            return false;</span>
        }

<span class="nc bnc" id="L274" title="All 6 branches missed.">        if (uuid != null ? !uuid.equals(thatS3TO.uuid) : thatS3TO.uuid != null) {</span>
<span class="nc" id="L275">            return false;</span>
        }

<span class="nc bnc" id="L278" title="All 6 branches missed.">        if (maxErrorRetry != null ? !maxErrorRetry.equals(thatS3TO.maxErrorRetry) : thatS3TO.maxErrorRetry != null) {</span>
<span class="nc" id="L279">            return false;</span>
        }

<span class="nc bnc" id="L282" title="All 6 branches missed.">        if (secretKey != null ? !secretKey.equals(thatS3TO.secretKey) : thatS3TO.secretKey != null) {</span>
<span class="nc" id="L283">            return false;</span>
        }

<span class="nc bnc" id="L286" title="All 6 branches missed.">        if (socketTimeout != null ? !socketTimeout.equals(thatS3TO.socketTimeout) : thatS3TO.socketTimeout != null) {</span>
<span class="nc" id="L287">            return false;</span>
        }

<span class="nc bnc" id="L290" title="All 6 branches missed.">        if (connectionTtl != null ? !connectionTtl.equals(thatS3TO.connectionTtl) : thatS3TO.connectionTtl != null) {</span>
<span class="nc" id="L291">            return false;</span>
        }

<span class="nc bnc" id="L294" title="All 6 branches missed.">        if (useTCPKeepAlive != null ? !useTCPKeepAlive.equals(thatS3TO.useTCPKeepAlive) : thatS3TO.useTCPKeepAlive != null) {</span>
<span class="nc" id="L295">            return false;</span>
        }

<span class="nc bnc" id="L298" title="All 6 branches missed.">        if (bucketName != null ? !bucketName.equals(thatS3TO.bucketName) : thatS3TO.bucketName != null) {</span>
<span class="nc" id="L299">            return false;</span>
        }

<span class="nc bnc" id="L302" title="All 6 branches missed.">        if (signer != null ? !signer.equals(thatS3TO.signer) : thatS3TO.signer != null) {</span>
<span class="nc" id="L303">            return false;</span>
        }

<span class="nc bnc" id="L306" title="All 6 branches missed.">        if (created != null ? !created.equals(thatS3TO.created) : thatS3TO.created != null) {</span>
<span class="nc" id="L307">            return false;</span>
        }

<span class="nc bnc" id="L310" title="All 2 branches missed.">        if (enableRRS != thatS3TO.enableRRS) {</span>
<span class="nc" id="L311">            return false;</span>
        }

<span class="nc" id="L314">        return true;</span>

    }

    @Override
    public int hashCode() {

<span class="nc bnc" id="L321" title="All 2 branches missed.">        int result = id != null ? id.hashCode() : 0;</span>

<span class="nc bnc" id="L323" title="All 2 branches missed.">        result = 31 * result + (accessKey != null ? accessKey.hashCode() : 0);</span>
<span class="nc bnc" id="L324" title="All 2 branches missed.">        result = 31 * result + (secretKey != null ? secretKey.hashCode() : 0);</span>
<span class="nc bnc" id="L325" title="All 2 branches missed.">        result = 31 * result + (endPoint != null ? endPoint.hashCode() : 0);</span>
<span class="nc bnc" id="L326" title="All 2 branches missed.">        result = 31 * result + (bucketName != null ? bucketName.hashCode() : 0);</span>
<span class="nc bnc" id="L327" title="All 2 branches missed.">        result = 31 * result + (signer != null ? signer.hashCode() : 0);</span>
<span class="nc bnc" id="L328" title="All 2 branches missed.">        result = 31 * result + (httpsFlag ? 1 : 0);</span>
<span class="nc bnc" id="L329" title="All 2 branches missed.">        result = 31 * result + (connectionTimeout != null ? connectionTimeout.hashCode() : 0);</span>
<span class="nc bnc" id="L330" title="All 2 branches missed.">        result = 31 * result + (maxErrorRetry != null ? maxErrorRetry.hashCode() : 0);</span>
<span class="nc bnc" id="L331" title="All 2 branches missed.">        result = 31 * result + (socketTimeout != null ? socketTimeout.hashCode() : 0);</span>
<span class="nc bnc" id="L332" title="All 2 branches missed.">        result = 31 * result + (connectionTtl != null ? connectionTtl.hashCode() : 0);</span>
<span class="nc bnc" id="L333" title="All 2 branches missed.">        result = 31 * result + (useTCPKeepAlive ? 1 : 0);</span>

<span class="nc" id="L335">        return result;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span>cloud-core (18-mrt-2016 13:14:54)</div></body></html>