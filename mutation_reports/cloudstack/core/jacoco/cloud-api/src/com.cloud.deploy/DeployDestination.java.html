<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../.resources/report.gif" type="image/gif"/><title>DeployDestination.java</title><link rel="stylesheet" href="../../../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../.sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">cloud-core (18-mrt-2016 13:14:54)</a> &gt; <a href="../../index.html" class="el_group">cloud-api</a> &gt; <a href="../index.html" class="el_bundle">src</a> &gt; <a href="index.source.html" class="el_package">com.cloud.deploy</a> &gt; <span class="el_source">DeployDestination.java</span></div><h1>DeployDestination.java</h1><pre class="source lang-java linenums">// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// &quot;License&quot;); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
package com.cloud.deploy;

import java.io.Serializable;
import java.util.Map;

import com.cloud.dc.DataCenter;
import com.cloud.dc.Pod;
import com.cloud.host.Host;
import com.cloud.org.Cluster;
import com.cloud.storage.StoragePool;
import com.cloud.storage.Volume;
import com.cloud.utils.NumbersUtil;

public class DeployDestination implements Serializable {
    private static final long serialVersionUID = 7113840781939014695L;

    DataCenter _dc;
    Pod _pod;
    Cluster _cluster;
    Host _host;
    Map&lt;Volume, StoragePool&gt; _storage;

    public DataCenter getDataCenter() {
<span class="nc" id="L40">        return _dc;</span>
    }

    public Pod getPod() {
<span class="nc" id="L44">        return _pod;</span>
    }

    public Cluster getCluster() {
<span class="nc" id="L48">        return _cluster;</span>
    }

    public Host getHost() {
<span class="nc" id="L52">        return _host;</span>
    }

    public Map&lt;Volume, StoragePool&gt; getStorageForDisks() {
<span class="nc" id="L56">        return _storage;</span>
    }

<span class="nc" id="L59">    public DeployDestination(DataCenter dc, Pod pod, Cluster cluster, Host host) {</span>
<span class="nc" id="L60">        _dc = dc;</span>
<span class="nc" id="L61">        _pod = pod;</span>
<span class="nc" id="L62">        _cluster = cluster;</span>
<span class="nc" id="L63">        _host = host;</span>
<span class="nc" id="L64">    }</span>

    public DeployDestination(DataCenter dc, Pod pod, Cluster cluster, Host host, Map&lt;Volume, StoragePool&gt; storage) {
<span class="nc" id="L67">        this(dc, pod, cluster, host);</span>
<span class="nc" id="L68">        _storage = storage;</span>
<span class="nc" id="L69">    }</span>

<span class="nc" id="L71">    public DeployDestination() {</span>
<span class="nc" id="L72">    }</span>

    @Override
    public int hashCode() {
<span class="nc" id="L76">        return NumbersUtil.hash(_host.getId());</span>
    }

    @Override
    public boolean equals(Object obj) {
<span class="nc" id="L81">        DeployDestination that = (DeployDestination)obj;</span>
<span class="nc bnc" id="L82" title="All 4 branches missed.">        if (_dc == null || that._dc == null) {</span>
<span class="nc" id="L83">            return false;</span>
        }
<span class="nc bnc" id="L85" title="All 2 branches missed.">        if (_dc.getId() != that._dc.getId()) {</span>
<span class="nc" id="L86">            return false;</span>
        }
<span class="nc bnc" id="L88" title="All 4 branches missed.">        if (_pod == null || that._pod == null) {</span>
<span class="nc" id="L89">            return false;</span>
        }
<span class="nc bnc" id="L91" title="All 2 branches missed.">        if (_pod.getId() != that._pod.getId()) {</span>
<span class="nc" id="L92">            return false;</span>
        }
<span class="nc bnc" id="L94" title="All 4 branches missed.">        if (_cluster == null || that._cluster == null) {</span>
<span class="nc" id="L95">            return false;</span>
        }
<span class="nc bnc" id="L97" title="All 2 branches missed.">        if (_cluster.getId() != that._cluster.getId()) {</span>
<span class="nc" id="L98">            return false;</span>
        }
<span class="nc bnc" id="L100" title="All 4 branches missed.">        if (_host == null || that._host == null) {</span>
<span class="nc" id="L101">            return false;</span>
        }
<span class="nc bnc" id="L103" title="All 2 branches missed.">        return _host.getId() == that._host.getId();</span>
    }

    @Override
    public String toString() {

<span class="nc" id="L109">        Long dcId = null;</span>
<span class="nc" id="L110">        Long podId = null;</span>
<span class="nc" id="L111">        Long clusterId = null;</span>
<span class="nc" id="L112">        Long hostId = null;</span>

<span class="nc bnc" id="L114" title="All 2 branches missed.">        if (_dc != null) {</span>
<span class="nc" id="L115">            dcId = _dc.getId();</span>
        }

<span class="nc bnc" id="L118" title="All 2 branches missed.">        if (_pod != null) {</span>
<span class="nc" id="L119">            podId = _pod.getId();</span>
        }

<span class="nc bnc" id="L122" title="All 2 branches missed.">        if (_cluster != null) {</span>
<span class="nc" id="L123">            clusterId = _cluster.getId();</span>
        }

<span class="nc bnc" id="L126" title="All 2 branches missed.">        if (_host != null) {</span>
<span class="nc" id="L127">            hostId = _host.getId();</span>
        }

<span class="nc" id="L130">        StringBuilder destination = new StringBuilder(&quot;Dest[Zone(Id)-Pod(Id)-Cluster(Id)-Host(Id)-Storage(Volume(Id|Type--&gt;Pool(Id))] : Dest[&quot;);</span>
<span class="nc" id="L131">        destination.append(&quot;Zone(&quot;).append(dcId).append(&quot;)&quot;).append(&quot;-&quot;);</span>
<span class="nc" id="L132">        destination.append(&quot;Pod(&quot;).append(podId).append(&quot;)&quot;).append(&quot;-&quot;);</span>
<span class="nc" id="L133">        destination.append(&quot;Cluster(&quot;).append(clusterId).append(&quot;)&quot;).append(&quot;-&quot;);</span>
<span class="nc" id="L134">        destination.append(&quot;Host(&quot;).append(hostId).append(&quot;)&quot;).append(&quot;-&quot;);</span>
<span class="nc" id="L135">        destination.append(&quot;Storage(&quot;);</span>
<span class="nc bnc" id="L136" title="All 2 branches missed.">        if (_storage != null) {</span>
<span class="nc" id="L137">            StringBuffer storageBuf = new StringBuffer();</span>
            //String storageStr = &quot;&quot;;
<span class="nc bnc" id="L139" title="All 2 branches missed.">            for (Volume vol : _storage.keySet()) {</span>
<span class="nc bnc" id="L140" title="All 2 branches missed.">                if (!storageBuf.toString().equals(&quot;&quot;)) {</span>
<span class="nc" id="L141">                    storageBuf.append(storageBuf.toString());</span>
<span class="nc" id="L142">                    storageBuf.append(&quot;, &quot;);</span>
                }
<span class="nc" id="L144">                storageBuf.append(storageBuf);</span>
<span class="nc" id="L145">                storageBuf.append(&quot;Volume(&quot;);</span>
<span class="nc" id="L146">                storageBuf.append(vol.getId());</span>
<span class="nc" id="L147">                storageBuf.append(&quot;|&quot;);</span>
<span class="nc" id="L148">                storageBuf.append(vol.getVolumeType().name());</span>
<span class="nc" id="L149">                storageBuf.append(&quot;--&gt;Pool(&quot;);</span>
<span class="nc" id="L150">                storageBuf.append(_storage.get(vol).getId());</span>
<span class="nc" id="L151">                storageBuf.append(&quot;)&quot;);</span>
            }
<span class="nc" id="L153">            destination.append(storageBuf.toString());</span>
        }
<span class="nc" id="L155">        return destination.append(&quot;)]&quot;).toString();</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span>cloud-core (18-mrt-2016 13:14:54)</div></body></html>