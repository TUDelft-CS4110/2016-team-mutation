<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>XmlReader.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">libGDX Core</a> &gt; <a href="index.html" class="el_package">com.badlogic.gdx.utils</a> &gt; <span class="el_source">XmlReader.java</span></div><h1>XmlReader.java</h1><pre class="source lang-java linenums">// line 1 &quot;XmlReader.rl&quot;
// Do not edit this file! Generated by Ragel.
// Ragel.exe -G2 -J -o XmlReader.java XmlReader.rl
/*******************************************************************************
 * Copyright 2011 See AUTHORS file.
 * 
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *   http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 ******************************************************************************/

package com.badlogic.gdx.utils;

import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.Reader;

import com.badlogic.gdx.files.FileHandle;
import com.badlogic.gdx.utils.ObjectMap.Entry;

/** Lightweight XML parser. Supports a subset of XML features: elements, attributes, text, predefined entities, CDATA, mixed
 * content. Namespaces are parsed as part of the element or attribute name. Prologs and doctypes are ignored. Only 8-bit character
 * encodings are supported. Input is assumed to be well formed.&lt;br&gt;
 * &lt;br&gt;
 * The default behavior is to parse the XML into a DOM. Extends this class and override methods to perform event driven parsing.
 * When this is done, the parse methods will return null.
 * @author Nathan Sweet */
<span class="nc" id="L37">public class XmlReader {</span>
<span class="nc" id="L38">	private final Array&lt;Element&gt; elements = new Array(8);</span>
	private Element root, current;
<span class="nc" id="L40">	private final StringBuilder textBuffer = new StringBuilder(64);</span>

	public Element parse (String xml) {
<span class="nc" id="L43">		char[] data = xml.toCharArray();</span>
<span class="nc" id="L44">		return parse(data, 0, data.length);</span>
	}

	public Element parse (Reader reader) throws IOException {
		try {
<span class="nc" id="L49">			char[] data = new char[1024];</span>
<span class="nc" id="L50">			int offset = 0;</span>
			while (true) {
<span class="nc" id="L52">				int length = reader.read(data, offset, data.length - offset);</span>
<span class="nc bnc" id="L53" title="All 2 branches missed.">				if (length == -1) break;</span>
<span class="nc bnc" id="L54" title="All 2 branches missed.">				if (length == 0) {</span>
<span class="nc" id="L55">					char[] newData = new char[data.length * 2];</span>
<span class="nc" id="L56">					System.arraycopy(data, 0, newData, 0, data.length);</span>
<span class="nc" id="L57">					data = newData;</span>
<span class="nc" id="L58">				} else</span>
<span class="nc" id="L59">					offset += length;</span>
<span class="nc" id="L60">			}</span>
<span class="nc" id="L61">			return parse(data, 0, offset);</span>
<span class="nc" id="L62">		} catch (IOException ex) {</span>
<span class="nc" id="L63">			throw new SerializationException(ex);</span>
		} finally {
<span class="nc" id="L65">			StreamUtils.closeQuietly(reader);</span>
		}
	}

	public Element parse (InputStream input) throws IOException {
		try {
<span class="nc" id="L71">			return parse(new InputStreamReader(input, &quot;UTF-8&quot;));</span>
<span class="nc" id="L72">		} catch (IOException ex) {</span>
<span class="nc" id="L73">			throw new SerializationException(ex);</span>
		} finally {
<span class="nc" id="L75">			StreamUtils.closeQuietly(input);</span>
		}
	}

	public Element parse (FileHandle file) throws IOException {
		try {
<span class="nc" id="L81">			return parse(file.reader(&quot;UTF-8&quot;));</span>
<span class="nc" id="L82">		} catch (Exception ex) {</span>
<span class="nc" id="L83">			throw new SerializationException(&quot;Error parsing file: &quot; + file, ex);</span>
		}
	}

	public Element parse (char[] data, int offset, int length) {
<span class="nc" id="L88">		int cs, p = offset, pe = length;</span>

<span class="nc" id="L90">		int s = 0;</span>
<span class="nc" id="L91">		String attributeName = null;</span>
<span class="nc" id="L92">		boolean hasBody = false;</span>

		// line 93 &quot;XmlReader.java&quot;
		{
<span class="nc" id="L96">			cs = xml_start;</span>
		}

		// line 97 &quot;XmlReader.java&quot;
		{
			int _klen;
<span class="nc" id="L102">			int _trans = 0;</span>
			int _acts;
			int _nacts;
			int _keys;
<span class="nc" id="L106">			int _goto_targ = 0;</span>

			_goto:
			while (true) {
<span class="nc bnc" id="L110" title="All 4 branches missed.">				switch (_goto_targ) {</span>
				case 0:
<span class="nc bnc" id="L112" title="All 2 branches missed.">					if (p == pe) {</span>
<span class="nc" id="L113">						_goto_targ = 4;</span>
<span class="nc" id="L114">						continue _goto;</span>
					}
<span class="nc bnc" id="L116" title="All 2 branches missed.">					if (cs == 0) {</span>
<span class="nc" id="L117">						_goto_targ = 5;</span>
<span class="nc" id="L118">						continue _goto;</span>
					}
				case 1:
					_match:
					do {
<span class="nc" id="L123">						_keys = _xml_key_offsets[cs];</span>
<span class="nc" id="L124">						_trans = _xml_index_offsets[cs];</span>
<span class="nc" id="L125">						_klen = _xml_single_lengths[cs];</span>
<span class="nc bnc" id="L126" title="All 2 branches missed.">						if (_klen &gt; 0) {</span>
<span class="nc" id="L127">							int _lower = _keys;</span>
							int _mid;
<span class="nc" id="L129">							int _upper = _keys + _klen - 1;</span>
							while (true) {
<span class="nc bnc" id="L131" title="All 2 branches missed.">								if (_upper &lt; _lower) break;</span>

<span class="nc" id="L133">								_mid = _lower + ((_upper - _lower) &gt;&gt; 1);</span>
<span class="nc bnc" id="L134" title="All 2 branches missed.">								if (data[p] &lt; _xml_trans_keys[_mid])</span>
<span class="nc" id="L135">									_upper = _mid - 1;</span>
<span class="nc bnc" id="L136" title="All 2 branches missed.">								else if (data[p] &gt; _xml_trans_keys[_mid])</span>
<span class="nc" id="L137">									_lower = _mid + 1;</span>
								else {
<span class="nc" id="L139">									_trans += (_mid - _keys);</span>
<span class="nc" id="L140">									break _match;</span>
								}
							}
<span class="nc" id="L143">							_keys += _klen;</span>
<span class="nc" id="L144">							_trans += _klen;</span>
						}

<span class="nc" id="L147">						_klen = _xml_range_lengths[cs];</span>
<span class="nc bnc" id="L148" title="All 2 branches missed.">						if (_klen &gt; 0) {</span>
<span class="nc" id="L149">							int _lower = _keys;</span>
							int _mid;
<span class="nc" id="L151">							int _upper = _keys + (_klen &lt;&lt; 1) - 2;</span>
							while (true) {
<span class="nc bnc" id="L153" title="All 2 branches missed.">								if (_upper &lt; _lower) break;</span>

<span class="nc" id="L155">								_mid = _lower + (((_upper - _lower) &gt;&gt; 1) &amp; ~1);</span>
<span class="nc bnc" id="L156" title="All 2 branches missed.">								if (data[p] &lt; _xml_trans_keys[_mid])</span>
<span class="nc" id="L157">									_upper = _mid - 2;</span>
<span class="nc bnc" id="L158" title="All 2 branches missed.">								else if (data[p] &gt; _xml_trans_keys[_mid + 1])</span>
<span class="nc" id="L159">									_lower = _mid + 2;</span>
								else {
<span class="nc" id="L161">									_trans += ((_mid - _keys) &gt;&gt; 1);</span>
<span class="nc" id="L162">									break _match;</span>
								}
							}
<span class="nc" id="L165">							_trans += _klen;</span>
						}
					} while (false);

<span class="nc" id="L169">					_trans = _xml_indicies[_trans];</span>
<span class="nc" id="L170">					cs = _xml_trans_targs[_trans];</span>

<span class="nc bnc" id="L172" title="All 2 branches missed.">					if (_xml_trans_actions[_trans] != 0) {</span>
<span class="nc" id="L173">						_acts = _xml_trans_actions[_trans];</span>
<span class="nc" id="L174">						_nacts = (int)_xml_actions[_acts++];</span>
<span class="nc bnc" id="L175" title="All 2 branches missed.">						while (_nacts-- &gt; 0) {</span>
<span class="nc bnc" id="L176" title="All 9 branches missed.">							switch (_xml_actions[_acts++]) {</span>
							case 0:
							// line 94 &quot;XmlReader.rl&quot;
							{
<span class="nc" id="L180">								s = p;</span>
							}
<span class="nc" id="L182">								break;</span>
							case 1:
							// line 95 &quot;XmlReader.rl&quot;
							{
<span class="nc" id="L186">								char c = data[s];</span>
<span class="nc bnc" id="L187" title="All 4 branches missed.">								if (c == '?' || c == '!') {</span>
<span class="nc bnc" id="L188" title="All 14 branches missed.">									if (data[s + 1] == '[' &amp;&amp; //</span>
										data[s + 2] == 'C' &amp;&amp; //
										data[s + 3] == 'D' &amp;&amp; //
										data[s + 4] == 'A' &amp;&amp; //
										data[s + 5] == 'T' &amp;&amp; //
										data[s + 6] == 'A' &amp;&amp; //
										data[s + 7] == '[') {
<span class="nc" id="L195">										s += 8;</span>
<span class="nc" id="L196">										p = s + 2;</span>
<span class="nc bnc" id="L197" title="All 6 branches missed.">										while (data[p - 2] != ']' || data[p - 1] != ']' || data[p] != '&gt;')</span>
<span class="nc" id="L198">											p++;</span>
<span class="nc" id="L199">										text(new String(data, s, p - s - 2));</span>
<span class="nc bnc" id="L200" title="All 6 branches missed.">									} else if (c == '!' &amp;&amp; data[s + 1] == '-' &amp;&amp; data[s + 2] == '-') {</span>
<span class="nc" id="L201">										p = s + 3;</span>
<span class="nc bnc" id="L202" title="All 6 branches missed.">										while (data[p] != '-' || data[p + 1] != '-' || data[p + 2] != '&gt;')</span>
<span class="nc" id="L203">											p++;</span>
<span class="nc" id="L204">										p += 2;</span>
									} else
<span class="nc bnc" id="L206" title="All 2 branches missed.">										while (data[p] != '&gt;')</span>
<span class="nc" id="L207">											p++;</span>
									{
<span class="nc" id="L209">										cs = 15;</span>
<span class="nc" id="L210">										_goto_targ = 2;</span>
<span class="nc" id="L211">										if (true) continue _goto;</span>
									}
								}
<span class="nc" id="L214">								hasBody = true;</span>
<span class="nc" id="L215">								open(new String(data, s, p - s));</span>
							}
<span class="nc" id="L217">								break;</span>
							case 2:
							// line 125 &quot;XmlReader.rl&quot;
							{
<span class="nc" id="L221">								hasBody = false;</span>
<span class="nc" id="L222">								close();</span>
								{
<span class="nc" id="L224">									cs = 15;</span>
<span class="nc" id="L225">									_goto_targ = 2;</span>
<span class="nc" id="L226">									if (true) continue _goto;</span>
								}
							}
								break;
							case 3:
							// line 130 &quot;XmlReader.rl&quot;
							{
<span class="nc" id="L233">								close();</span>
								{
<span class="nc" id="L235">									cs = 15;</span>
<span class="nc" id="L236">									_goto_targ = 2;</span>
<span class="nc" id="L237">									if (true) continue _goto;</span>
								}
							}
								break;
							case 4:
							// line 134 &quot;XmlReader.rl&quot;
							{
<span class="nc bnc" id="L244" title="All 2 branches missed.">								if (hasBody) {</span>
<span class="nc" id="L245">									cs = 15;</span>
<span class="nc" id="L246">									_goto_targ = 2;</span>
<span class="nc" id="L247">									if (true) continue _goto;</span>
								}
							}
								break;
							case 5:
							// line 137 &quot;XmlReader.rl&quot;
							{
<span class="nc" id="L254">								attributeName = new String(data, s, p - s);</span>
							}
<span class="nc" id="L256">								break;</span>
							case 6:
							// line 140 &quot;XmlReader.rl&quot;
							{
<span class="nc" id="L260">								attribute(attributeName, new String(data, s, p - s));</span>
							}
<span class="nc" id="L262">								break;</span>
							case 7:
							// line 143 &quot;XmlReader.rl&quot;
							{
<span class="nc" id="L266">								int end = p;</span>
<span class="nc bnc" id="L267" title="All 2 branches missed.">								while (end != s) {</span>
<span class="nc bnc" id="L268" title="All 2 branches missed.">									switch (data[end - 1]) {</span>
									case ' ':
									case '\t':
									case '\n':
									case '\r':
<span class="nc" id="L273">										end--;</span>
<span class="nc" id="L274">										continue;</span>
									}
<span class="nc" id="L276">									break;</span>
								}
<span class="nc" id="L278">								int current = s;</span>
<span class="nc" id="L279">								boolean entityFound = false;</span>
<span class="nc bnc" id="L280" title="All 2 branches missed.">								while (current != end) {</span>
<span class="nc bnc" id="L281" title="All 2 branches missed.">									if (data[current++] != '&amp;') continue;</span>
<span class="nc" id="L282">									int entityStart = current;</span>
<span class="nc bnc" id="L283" title="All 2 branches missed.">									while (current != end) {</span>
<span class="nc bnc" id="L284" title="All 2 branches missed.">										if (data[current++] != ';') continue;</span>
<span class="nc" id="L285">										textBuffer.append(data, s, entityStart - s - 1);</span>
<span class="nc" id="L286">										String name = new String(data, entityStart, current - entityStart - 1);</span>
<span class="nc" id="L287">										String value = entity(name);</span>
<span class="nc bnc" id="L288" title="All 2 branches missed.">										textBuffer.append(value != null ? value : name);</span>
<span class="nc" id="L289">										s = current;</span>
<span class="nc" id="L290">										entityFound = true;</span>
<span class="nc" id="L291">										break;</span>
									}
<span class="nc" id="L293">								}</span>
<span class="nc bnc" id="L294" title="All 2 branches missed.">								if (entityFound) {</span>
<span class="nc bnc" id="L295" title="All 2 branches missed.">									if (s &lt; end) textBuffer.append(data, s, end - s);</span>
<span class="nc" id="L296">									text(textBuffer.toString());</span>
<span class="nc" id="L297">									textBuffer.setLength(0);</span>
								} else
<span class="nc" id="L299">									text(new String(data, s, end - s));</span>
							}
<span class="nc" id="L301">								break;</span>
							// line 286 &quot;XmlReader.java&quot;
							}
						}
					}

				case 2:
<span class="nc bnc" id="L308" title="All 2 branches missed.">					if (cs == 0) {</span>
<span class="nc" id="L309">						_goto_targ = 5;</span>
<span class="nc" id="L310">						continue _goto;</span>
					}
<span class="nc bnc" id="L312" title="All 2 branches missed.">					if (++p != pe) {</span>
<span class="nc" id="L313">						_goto_targ = 1;</span>
<span class="nc" id="L314">						continue _goto;</span>
					}
				case 4:
				case 5:
				}
<span class="nc" id="L319">				break;</span>
			}
		}

		// line 190 &quot;XmlReader.rl&quot;

<span class="nc bnc" id="L325" title="All 2 branches missed.">		if (p &lt; pe) {</span>
<span class="nc" id="L326">			int lineNumber = 1;</span>
<span class="nc bnc" id="L327" title="All 2 branches missed.">			for (int i = 0; i &lt; p; i++)</span>
<span class="nc bnc" id="L328" title="All 2 branches missed.">				if (data[i] == '\n') lineNumber++;</span>
<span class="nc" id="L329">			throw new SerializationException(&quot;Error parsing XML on line &quot; + lineNumber + &quot; near: &quot;</span>
				+ new String(data, p, Math.min(32, pe - p)));
<span class="nc bnc" id="L331" title="All 2 branches missed.">		} else if (elements.size != 0) {</span>
<span class="nc" id="L332">			Element element = elements.peek();</span>
<span class="nc" id="L333">			elements.clear();</span>
<span class="nc" id="L334">			throw new SerializationException(&quot;Error parsing XML, unclosed element: &quot; + element.getName());</span>
		}
<span class="nc" id="L336">		Element root = this.root;</span>
<span class="nc" id="L337">		this.root = null;</span>
<span class="nc" id="L338">		return root;</span>
	}

	// line 324 &quot;XmlReader.java&quot;
	private static byte[] init__xml_actions_0 () {
<span class="nc" id="L343">		return new byte[] {0, 1, 0, 1, 1, 1, 2, 1, 3, 1, 4, 1, 5, 1, 6, 1, 7, 2, 0, 6, 2, 1, 4, 2, 2, 4};</span>
	}

<span class="nc" id="L346">	private static final byte _xml_actions[] = init__xml_actions_0();</span>

	private static byte[] init__xml_key_offsets_0 () {
<span class="nc" id="L349">		return new byte[] {0, 0, 4, 9, 14, 20, 26, 30, 35, 36, 37, 42, 46, 50, 51, 52, 56, 57, 62, 67, 73, 79, 83, 88, 89, 90, 95,</span>
			99, 103, 104, 108, 109, 110, 111, 112, 115};
	}

<span class="nc" id="L353">	private static final byte _xml_key_offsets[] = init__xml_key_offsets_0();</span>

	private static char[] init__xml_trans_keys_0 () {
<span class="nc" id="L356">		return new char[] {32, 60, 9, 13, 32, 47, 62, 9, 13, 32, 47, 62, 9, 13, 32, 47, 61, 62, 9, 13, 32, 47, 61, 62, 9, 13, 32,</span>
			61, 9, 13, 32, 34, 39, 9, 13, 34, 34, 32, 47, 62, 9, 13, 32, 62, 9, 13, 32, 62, 9, 13, 39, 39, 32, 60, 9, 13, 60, 32,
			47, 62, 9, 13, 32, 47, 62, 9, 13, 32, 47, 61, 62, 9, 13, 32, 47, 61, 62, 9, 13, 32, 61, 9, 13, 32, 34, 39, 9, 13, 34,
			34, 32, 47, 62, 9, 13, 32, 62, 9, 13, 32, 62, 9, 13, 60, 32, 47, 9, 13, 62, 62, 39, 39, 32, 9, 13, 0};
	}

<span class="nc" id="L362">	private static final char _xml_trans_keys[] = init__xml_trans_keys_0();</span>

	private static byte[] init__xml_single_lengths_0 () {
<span class="nc" id="L365">		return new byte[] {0, 2, 3, 3, 4, 4, 2, 3, 1, 1, 3, 2, 2, 1, 1, 2, 1, 3, 3, 4, 4, 2, 3, 1, 1, 3, 2, 2, 1, 2, 1, 1, 1, 1, 1,</span>
			0};
	}

<span class="nc" id="L369">	private static final byte _xml_single_lengths[] = init__xml_single_lengths_0();</span>

	private static byte[] init__xml_range_lengths_0 () {
<span class="nc" id="L372">		return new byte[] {0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1,</span>
			0};
	}

<span class="nc" id="L376">	private static final byte _xml_range_lengths[] = init__xml_range_lengths_0();</span>

	private static short[] init__xml_index_offsets_0 () {
<span class="nc" id="L379">		return new short[] {0, 0, 4, 9, 14, 20, 26, 30, 35, 37, 39, 44, 48, 52, 54, 56, 60, 62, 67, 72, 78, 84, 88, 93, 95, 97,</span>
			102, 106, 110, 112, 116, 118, 120, 122, 124, 127};
	}

<span class="nc" id="L383">	private static final short _xml_index_offsets[] = init__xml_index_offsets_0();</span>

	private static byte[] init__xml_indicies_0 () {
<span class="nc" id="L386">		return new byte[] {0, 2, 0, 1, 2, 1, 1, 2, 3, 5, 6, 7, 5, 4, 9, 10, 1, 11, 9, 8, 13, 1, 14, 1, 13, 12, 15, 16, 15, 1, 16,</span>
			17, 18, 16, 1, 20, 19, 22, 21, 9, 10, 11, 9, 1, 23, 24, 23, 1, 25, 11, 25, 1, 20, 26, 22, 27, 29, 30, 29, 28, 32, 31,
			30, 34, 1, 30, 33, 36, 37, 38, 36, 35, 40, 41, 1, 42, 40, 39, 44, 1, 45, 1, 44, 43, 46, 47, 46, 1, 47, 48, 49, 47, 1,
			51, 50, 53, 52, 40, 41, 42, 40, 1, 54, 55, 54, 1, 56, 42, 56, 1, 57, 1, 57, 34, 57, 1, 1, 58, 59, 58, 51, 60, 53, 61,
			62, 62, 1, 1, 0};
	}

<span class="nc" id="L393">	private static final byte _xml_indicies[] = init__xml_indicies_0();</span>

	private static byte[] init__xml_trans_targs_0 () {
<span class="nc" id="L396">		return new byte[] {1, 0, 2, 3, 3, 4, 11, 34, 5, 4, 11, 34, 5, 6, 7, 6, 7, 8, 13, 9, 10, 9, 10, 12, 34, 12, 14, 14, 16, 15,</span>
			17, 16, 17, 18, 30, 18, 19, 26, 28, 20, 19, 26, 28, 20, 21, 22, 21, 22, 23, 32, 24, 25, 24, 25, 27, 28, 27, 29, 31, 35,
			33, 33, 34};
	}

<span class="nc" id="L401">	private static final byte _xml_trans_targs[] = init__xml_trans_targs_0();</span>

	private static byte[] init__xml_trans_actions_0 () {
<span class="nc" id="L404">		return new byte[] {0, 0, 0, 1, 0, 3, 3, 20, 1, 0, 0, 9, 0, 11, 11, 0, 0, 0, 0, 1, 17, 0, 13, 5, 23, 0, 1, 0, 1, 0, 0, 0,</span>
			15, 1, 0, 0, 3, 3, 20, 1, 0, 0, 9, 0, 11, 11, 0, 0, 0, 0, 1, 17, 0, 13, 5, 23, 0, 0, 0, 7, 1, 0, 0};
	}

<span class="nc" id="L408">	private static final byte _xml_trans_actions[] = init__xml_trans_actions_0();</span>

	static final int xml_start = 1;
	static final int xml_first_final = 34;
	static final int xml_error = 0;

	static final int xml_en_elementBody = 15;
	static final int xml_en_main = 1;

	// line 209 &quot;XmlReader.rl&quot;

	protected void open (String name) {
<span class="nc" id="L420">		Element child = new Element(name, current);</span>
<span class="nc" id="L421">		Element parent = current;</span>
<span class="nc bnc" id="L422" title="All 2 branches missed.">		if (parent != null) parent.addChild(child);</span>
<span class="nc" id="L423">		elements.add(child);</span>
<span class="nc" id="L424">		current = child;</span>
<span class="nc" id="L425">	}</span>

	protected void attribute (String name, String value) {
<span class="nc" id="L428">		current.setAttribute(name, value);</span>
<span class="nc" id="L429">	}</span>

	protected String entity (String name) {
<span class="nc bnc" id="L432" title="All 2 branches missed.">		if (name.equals(&quot;lt&quot;)) return &quot;&lt;&quot;;</span>
<span class="nc bnc" id="L433" title="All 2 branches missed.">		if (name.equals(&quot;gt&quot;)) return &quot;&gt;&quot;;</span>
<span class="nc bnc" id="L434" title="All 2 branches missed.">		if (name.equals(&quot;amp&quot;)) return &quot;&amp;&quot;;</span>
<span class="nc bnc" id="L435" title="All 2 branches missed.">		if (name.equals(&quot;apos&quot;)) return &quot;'&quot;;</span>
<span class="nc bnc" id="L436" title="All 2 branches missed.">		if (name.equals(&quot;quot&quot;)) return &quot;\&quot;&quot;;</span>
<span class="nc bnc" id="L437" title="All 2 branches missed.">		if (name.startsWith(&quot;#x&quot;)) return Character.toString((char)Integer.parseInt(name.substring(2), 16));</span>
<span class="nc" id="L438">		return null;</span>
	}

	protected void text (String text) {
<span class="nc" id="L442">		String existing = current.getText();</span>
<span class="nc bnc" id="L443" title="All 2 branches missed.">		current.setText(existing != null ? existing + text : text);</span>
<span class="nc" id="L444">	}</span>

	protected void close () {
<span class="nc" id="L447">		root = elements.pop();</span>
<span class="nc bnc" id="L448" title="All 2 branches missed.">		current = elements.size &gt; 0 ? elements.peek() : null;</span>
<span class="nc" id="L449">	}</span>

<span class="nc" id="L451">	static public class Element {</span>
		private final String name;
		private ObjectMap&lt;String, String&gt; attributes;
		private Array&lt;Element&gt; children;
		private String text;
		private Element parent;

<span class="nc" id="L458">		public Element (String name, Element parent) {</span>
<span class="nc" id="L459">			this.name = name;</span>
<span class="nc" id="L460">			this.parent = parent;</span>
<span class="nc" id="L461">		}</span>

		public String getName () {
<span class="nc" id="L464">			return name;</span>
		}

		public ObjectMap&lt;String, String&gt; getAttributes () {
<span class="nc" id="L468">			return attributes;</span>
		}

		/** @throws GdxRuntimeException if the attribute was not found. */
		public String getAttribute (String name) {
<span class="nc bnc" id="L473" title="All 2 branches missed.">			if (attributes == null) throw new GdxRuntimeException(&quot;Element &quot; + name + &quot; doesn't have attribute: &quot; + name);</span>
<span class="nc" id="L474">			String value = attributes.get(name);</span>
<span class="nc bnc" id="L475" title="All 2 branches missed.">			if (value == null) throw new GdxRuntimeException(&quot;Element &quot; + name + &quot; doesn't have attribute: &quot; + name);</span>
<span class="nc" id="L476">			return value;</span>
		}

		public String getAttribute (String name, String defaultValue) {
<span class="nc bnc" id="L480" title="All 2 branches missed.">			if (attributes == null) return defaultValue;</span>
<span class="nc" id="L481">			String value = attributes.get(name);</span>
<span class="nc bnc" id="L482" title="All 2 branches missed.">			if (value == null) return defaultValue;</span>
<span class="nc" id="L483">			return value;</span>
		}

		public void setAttribute (String name, String value) {
<span class="nc bnc" id="L487" title="All 2 branches missed.">			if (attributes == null) attributes = new ObjectMap(8);</span>
<span class="nc" id="L488">			attributes.put(name, value);</span>
<span class="nc" id="L489">		}</span>

		public int getChildCount () {
<span class="nc bnc" id="L492" title="All 2 branches missed.">			if (children == null) return 0;</span>
<span class="nc" id="L493">			return children.size;</span>
		}

		/** @throws GdxRuntimeException if the element has no children. */
		public Element getChild (int index) {
<span class="nc bnc" id="L498" title="All 2 branches missed.">			if (children == null) throw new GdxRuntimeException(&quot;Element has no children: &quot; + name);</span>
<span class="nc" id="L499">			return children.get(index);</span>
		}

		public void addChild (Element element) {
<span class="nc bnc" id="L503" title="All 2 branches missed.">			if (children == null) children = new Array(8);</span>
<span class="nc" id="L504">			children.add(element);</span>
<span class="nc" id="L505">		}</span>

		public String getText () {
<span class="nc" id="L508">			return text;</span>
		}

		public void setText (String text) {
<span class="nc" id="L512">			this.text = text;</span>
<span class="nc" id="L513">		}</span>

		public void removeChild (int index) {
<span class="nc bnc" id="L516" title="All 2 branches missed.">			if (children != null) children.removeIndex(index);</span>
<span class="nc" id="L517">		}</span>

		public void removeChild (Element child) {
<span class="nc bnc" id="L520" title="All 2 branches missed.">			if (children != null) children.removeValue(child, true);</span>
<span class="nc" id="L521">		}</span>

		public void remove () {
<span class="nc" id="L524">			parent.removeChild(this);</span>
<span class="nc" id="L525">		}</span>

		public Element getParent () {
<span class="nc" id="L528">			return parent;</span>
		}

		public String toString () {
<span class="nc" id="L532">			return toString(&quot;&quot;);</span>
		}

		public String toString (String indent) {
<span class="nc" id="L536">			StringBuilder buffer = new StringBuilder(128);</span>
<span class="nc" id="L537">			buffer.append(indent);</span>
<span class="nc" id="L538">			buffer.append('&lt;');</span>
<span class="nc" id="L539">			buffer.append(name);</span>
<span class="nc bnc" id="L540" title="All 2 branches missed.">			if (attributes != null) {</span>
<span class="nc bnc" id="L541" title="All 2 branches missed.">				for (Entry&lt;String, String&gt; entry : attributes.entries()) {</span>
<span class="nc" id="L542">					buffer.append(' ');</span>
<span class="nc" id="L543">					buffer.append(entry.key);</span>
<span class="nc" id="L544">					buffer.append(&quot;=\&quot;&quot;);</span>
<span class="nc" id="L545">					buffer.append(entry.value);</span>
<span class="nc" id="L546">					buffer.append('\&quot;');</span>
<span class="nc" id="L547">				}</span>
			}
<span class="nc bnc" id="L549" title="All 6 branches missed.">			if (children == null &amp;&amp; (text == null || text.length() == 0))</span>
<span class="nc" id="L550">				buffer.append(&quot;/&gt;&quot;);</span>
			else {
<span class="nc" id="L552">				buffer.append(&quot;&gt;\n&quot;);</span>
<span class="nc" id="L553">				String childIndent = indent + '\t';</span>
<span class="nc bnc" id="L554" title="All 4 branches missed.">				if (text != null &amp;&amp; text.length() &gt; 0) {</span>
<span class="nc" id="L555">					buffer.append(childIndent);</span>
<span class="nc" id="L556">					buffer.append(text);</span>
<span class="nc" id="L557">					buffer.append('\n');</span>
				}
<span class="nc bnc" id="L559" title="All 2 branches missed.">				if (children != null) {</span>
<span class="nc bnc" id="L560" title="All 2 branches missed.">					for (Element child : children) {</span>
<span class="nc" id="L561">						buffer.append(child.toString(childIndent));</span>
<span class="nc" id="L562">						buffer.append('\n');</span>
<span class="nc" id="L563">					}</span>
				}
<span class="nc" id="L565">				buffer.append(indent);</span>
<span class="nc" id="L566">				buffer.append(&quot;&lt;/&quot;);</span>
<span class="nc" id="L567">				buffer.append(name);</span>
<span class="nc" id="L568">				buffer.append('&gt;');</span>
			}
<span class="nc" id="L570">			return buffer.toString();</span>
		}

		/** @param name the name of the child {@link Element}
		 * @return the first child having the given name or null, does not recurse */
		public Element getChildByName (String name) {
<span class="nc bnc" id="L576" title="All 2 branches missed.">			if (children == null) return null;</span>
<span class="nc bnc" id="L577" title="All 2 branches missed.">			for (int i = 0; i &lt; children.size; i++) {</span>
<span class="nc" id="L578">				Element element = children.get(i);</span>
<span class="nc bnc" id="L579" title="All 2 branches missed.">				if (element.name.equals(name)) return element;</span>
			}
<span class="nc" id="L581">			return null;</span>
		}

		/** @param name the name of the child {@link Element}
		 * @return the first child having the given name or null, recurses */
		public Element getChildByNameRecursive (String name) {
<span class="nc bnc" id="L587" title="All 2 branches missed.">			if (children == null) return null;</span>
<span class="nc bnc" id="L588" title="All 2 branches missed.">			for (int i = 0; i &lt; children.size; i++) {</span>
<span class="nc" id="L589">				Element element = children.get(i);</span>
<span class="nc bnc" id="L590" title="All 2 branches missed.">				if (element.name.equals(name)) return element;</span>
<span class="nc" id="L591">				Element found = element.getChildByNameRecursive(name);</span>
<span class="nc bnc" id="L592" title="All 2 branches missed.">				if (found != null) return found;</span>
			}
<span class="nc" id="L594">			return null;</span>
		}

		/** @param name the name of the children
		 * @return the children with the given name or an empty {@link Array} */
		public Array&lt;Element&gt; getChildrenByName (String name) {
<span class="nc" id="L600">			Array&lt;Element&gt; result = new Array&lt;Element&gt;();</span>
<span class="nc bnc" id="L601" title="All 2 branches missed.">			if (children == null) return result;</span>
<span class="nc bnc" id="L602" title="All 2 branches missed.">			for (int i = 0; i &lt; children.size; i++) {</span>
<span class="nc" id="L603">				Element child = children.get(i);</span>
<span class="nc bnc" id="L604" title="All 2 branches missed.">				if (child.name.equals(name)) result.add(child);</span>
			}
<span class="nc" id="L606">			return result;</span>
		}

		/** @param name the name of the children
		 * @return the children with the given name or an empty {@link Array} */
		public Array&lt;Element&gt; getChildrenByNameRecursively (String name) {
<span class="nc" id="L612">			Array&lt;Element&gt; result = new Array&lt;Element&gt;();</span>
<span class="nc" id="L613">			getChildrenByNameRecursively(name, result);</span>
<span class="nc" id="L614">			return result;</span>
		}

		private void getChildrenByNameRecursively (String name, Array&lt;Element&gt; result) {
<span class="nc bnc" id="L618" title="All 2 branches missed.">			if (children == null) return;</span>
<span class="nc bnc" id="L619" title="All 2 branches missed.">			for (int i = 0; i &lt; children.size; i++) {</span>
<span class="nc" id="L620">				Element child = children.get(i);</span>
<span class="nc bnc" id="L621" title="All 2 branches missed.">				if (child.name.equals(name)) result.add(child);</span>
<span class="nc" id="L622">				child.getChildrenByNameRecursively(name, result);</span>
			}
<span class="nc" id="L624">		}</span>

		/** @throws GdxRuntimeException if the attribute was not found. */
		public float getFloatAttribute (String name) {
<span class="nc" id="L628">			return Float.parseFloat(getAttribute(name));</span>
		}

		public float getFloatAttribute (String name, float defaultValue) {
<span class="nc" id="L632">			String value = getAttribute(name, null);</span>
<span class="nc bnc" id="L633" title="All 2 branches missed.">			if (value == null) return defaultValue;</span>
<span class="nc" id="L634">			return Float.parseFloat(value);</span>
		}

		/** @throws GdxRuntimeException if the attribute was not found. */
		public int getIntAttribute (String name) {
<span class="nc" id="L639">			return Integer.parseInt(getAttribute(name));</span>
		}

		public int getIntAttribute (String name, int defaultValue) {
<span class="nc" id="L643">			String value = getAttribute(name, null);</span>
<span class="nc bnc" id="L644" title="All 2 branches missed.">			if (value == null) return defaultValue;</span>
<span class="nc" id="L645">			return Integer.parseInt(value);</span>
		}

		/** @throws GdxRuntimeException if the attribute was not found. */
		public boolean getBooleanAttribute (String name) {
<span class="nc" id="L650">			return Boolean.parseBoolean(getAttribute(name));</span>
		}

		public boolean getBooleanAttribute (String name, boolean defaultValue) {
<span class="nc" id="L654">			String value = getAttribute(name, null);</span>
<span class="nc bnc" id="L655" title="All 2 branches missed.">			if (value == null) return defaultValue;</span>
<span class="nc" id="L656">			return Boolean.parseBoolean(value);</span>
		}

		/** Returns the attribute value with the specified name, or if no attribute is found, the text of a child with the name.
		 * @throws GdxRuntimeException if no attribute or child was not found. */
		public String get (String name) {
<span class="nc" id="L662">			String value = get(name, null);</span>
<span class="nc bnc" id="L663" title="All 2 branches missed.">			if (value == null) throw new GdxRuntimeException(&quot;Element &quot; + this.name + &quot; doesn't have attribute or child: &quot; + name);</span>
<span class="nc" id="L664">			return value;</span>
		}

		/** Returns the attribute value with the specified name, or if no attribute is found, the text of a child with the name.
		 * @throws GdxRuntimeException if no attribute or child was not found. */
		public String get (String name, String defaultValue) {
<span class="nc bnc" id="L670" title="All 2 branches missed.">			if (attributes != null) {</span>
<span class="nc" id="L671">				String value = attributes.get(name);</span>
<span class="nc bnc" id="L672" title="All 2 branches missed.">				if (value != null) return value;</span>
			}
<span class="nc" id="L674">			Element child = getChildByName(name);</span>
<span class="nc bnc" id="L675" title="All 2 branches missed.">			if (child == null) return defaultValue;</span>
<span class="nc" id="L676">			String value = child.getText();</span>
<span class="nc bnc" id="L677" title="All 2 branches missed.">			if (value == null) return defaultValue;</span>
<span class="nc" id="L678">			return value;</span>
		}

		/** Returns the attribute value with the specified name, or if no attribute is found, the text of a child with the name.
		 * @throws GdxRuntimeException if no attribute or child was not found. */
		public int getInt (String name) {
<span class="nc" id="L684">			String value = get(name, null);</span>
<span class="nc bnc" id="L685" title="All 2 branches missed.">			if (value == null) throw new GdxRuntimeException(&quot;Element &quot; + this.name + &quot; doesn't have attribute or child: &quot; + name);</span>
<span class="nc" id="L686">			return Integer.parseInt(value);</span>
		}

		/** Returns the attribute value with the specified name, or if no attribute is found, the text of a child with the name.
		 * @throws GdxRuntimeException if no attribute or child was not found. */
		public int getInt (String name, int defaultValue) {
<span class="nc" id="L692">			String value = get(name, null);</span>
<span class="nc bnc" id="L693" title="All 2 branches missed.">			if (value == null) return defaultValue;</span>
<span class="nc" id="L694">			return Integer.parseInt(value);</span>
		}

		/** Returns the attribute value with the specified name, or if no attribute is found, the text of a child with the name.
		 * @throws GdxRuntimeException if no attribute or child was not found. */
		public float getFloat (String name) {
<span class="nc" id="L700">			String value = get(name, null);</span>
<span class="nc bnc" id="L701" title="All 2 branches missed.">			if (value == null) throw new GdxRuntimeException(&quot;Element &quot; + this.name + &quot; doesn't have attribute or child: &quot; + name);</span>
<span class="nc" id="L702">			return Float.parseFloat(value);</span>
		}

		/** Returns the attribute value with the specified name, or if no attribute is found, the text of a child with the name.
		 * @throws GdxRuntimeException if no attribute or child was not found. */
		public float getFloat (String name, float defaultValue) {
<span class="nc" id="L708">			String value = get(name, null);</span>
<span class="nc bnc" id="L709" title="All 2 branches missed.">			if (value == null) return defaultValue;</span>
<span class="nc" id="L710">			return Float.parseFloat(value);</span>
		}

		/** Returns the attribute value with the specified name, or if no attribute is found, the text of a child with the name.
		 * @throws GdxRuntimeException if no attribute or child was not found. */
		public boolean getBoolean (String name) {
<span class="nc" id="L716">			String value = get(name, null);</span>
<span class="nc bnc" id="L717" title="All 2 branches missed.">			if (value == null) throw new GdxRuntimeException(&quot;Element &quot; + this.name + &quot; doesn't have attribute or child: &quot; + name);</span>
<span class="nc" id="L718">			return Boolean.parseBoolean(value);</span>
		}

		/** Returns the attribute value with the specified name, or if no attribute is found, the text of a child with the name.
		 * @throws GdxRuntimeException if no attribute or child was not found. */
		public boolean getBoolean (String name, boolean defaultValue) {
<span class="nc" id="L724">			String value = get(name, null);</span>
<span class="nc bnc" id="L725" title="All 2 branches missed.">			if (value == null) return defaultValue;</span>
<span class="nc" id="L726">			return Boolean.parseBoolean(value);</span>
		}
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.5.5.201112152213</span></div></body></html>